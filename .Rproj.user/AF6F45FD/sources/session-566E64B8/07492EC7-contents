# subjects uniquely identified by subject id, files in long format for multiple eventnames (timepoints)

parents <- read.delim("~/Downloads/Package_1204091/abcd_ppdms01.txt")
parents_var_summary <- parents[1,]
parents <- parents[-1,]

children <- read.delim("~/Downloads/Package_1204091/abcd_ypdms01.txt")
children_var_summary <- children[1,]
children <- children[-1,]

# menstrualcycle6_y = Do your premenstrual symptoms interfere with your/her relationships with family and friends, productivity, and/or social life activities?
# menstrualcycle5_y = Do you experience premenstrual symptoms, such as irritability, fatigue, etc., which start before a period and stop within a few days of bleeding?
# menstrualcycle11_y = How much does your menstrual pain stop you from doing your usual activities? 0 (Not at all) - 10 (stops me from doing anything)
# menstrualcycle7_y = On average, how long does your menstrual period (bleeding) last?
# menstrualcycle8_y = Do you experience a light, medium, or heavy flow?
# menstrualcycle9_y = On average, how would you rate the intensity of your menstrual pain on a scale of 0-10? 0 (No pain at all) - 10 (the worst pain I have ever felt)
# menstrualcycle2_y = On average, how many days are there between the first day of your/your child's period and the first day of your/her next period? (e.g., 30 days)
# menstrualcycle3_y = Is your menstrual cycle regular?
# menstrualcycle4_y = Are you currently using hormonal birth control (eg. the pill, hormone patch, hormone injection)?


cbcl <- read.delim("~/Downloads/Package_1204091/abcd_cbcls01.txt")
cbcl_var_summary <- cbcl[1,]
cbcl <- cbcl[-1,]

# e.g. analysis
## cbcl at baseline in relation to menstrual traits 2 years follow-up
cbcl_baseline <- cbcl[which(cbcl$eventname=="baseline_year_1_arm_1"),] #cbcl at baseline
menstrual_children_2 <- children[which(children$eventname=="2_year_follow_up_y_arm_1"),] #menstrual questions at 2 year follow-up
dat <- merge(cbcl_baseline,menstrual_children_2,by="subjectkey",all=T)
dat$menstrualcycle6_y[dat$menstrualcycle6_y==777|dat$menstrualcycle6_y==""]<-NA
dat$menstrualcycle6_y <- as.numeric(dat$menstrualcycle6_y)
dat$cbcl_scr_dsm5_depress_t[dat$cbcl_scr_dsm5_depress_t==""]<-NA
dat$cbcl_scr_dsm5_depress_t <- as.numeric(dat$cbcl_scr_dsm5_depress_t)
summary(lm(dat$menstrualcycle6_y ~ dat$cbcl_scr_dsm5_depress_t))
cor(dat$menstrualcycle6_y, dat$cbcl_scr_dsm5_depress_t,use = "pairwise.complete")
boxplot(dat$cbcl_scr_dsm5_depress_t ~ dat$menstrualcycle6_y)

## menstrual traits at baseline in relation to cbcl 2 years follow-up
menstrual_children_baseline <- children[which(children$eventname=="baseline_year_1_arm_1"),] #menstrual questions at baseline
cbcl_2 <- cbcl[which(cbcl$eventname=="2_year_follow_up_y_arm_1"),] #cbcl at 2 year follow-up
dat <- merge(cbcl_2,menstrual_children_baseline,by="subjectkey",all=T)
dat$menstrualcycle6_y[dat$menstrualcycle6_y==999|dat$menstrualcycle6_y==777|dat$menstrualcycle6_y==""]<-NA
dat$menstrualcycle6_y <- as.numeric(dat$menstrualcycle6_y)
dat$cbcl_scr_dsm5_depress_t[dat$cbcl_scr_dsm5_depress_t==""]<-NA
dat$cbcl_scr_dsm5_depress_t <- as.numeric(dat$cbcl_scr_dsm5_depress_t)
summary(lm(dat$menstrualcycle6_y ~ dat$cbcl_scr_dsm5_depress_t))
cor(dat$menstrualcycle6_y, dat$cbcl_scr_dsm5_depress_t,use = "pairwise.complete")
boxplot(dat$cbcl_scr_dsm5_depress_t ~ dat$menstrualcycle6_y)

